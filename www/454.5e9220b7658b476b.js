"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[454],{9454:(U,f,s)=>{s.r(f),s.d(f,{HomePage:()=>p});var l=s(5861),n=s(9212),r=s(9251),y=s(2546),v=s(6973);function c(a,g){const d="object"==typeof g;return new Promise((t,e)=>{let o,i=!1;a.subscribe({next:u=>{o=u,i=!0},error:e,complete:()=>{i?t(o):d?t(g.defaultValue):e(new v.K)}})})}var h=s(2726);const m=(0,h.fo)("Preferences",{web:()=>s.e(899).then(s.bind(s,899)).then(a=>new a.PreferencesWeb)});let p=(()=>{var a;class g{constructor(t){this.toastCtrl=t,this.onesignal=(0,n.f3M)(y.C)}ngOnInit(){console.log("ngoninit"),"web"!=h.dV.getPlatform()&&this.oneSignal()}oneSignal(){var t=this;return(0,l.Z)(function*(){try{yield t.onesignal.OneSignalIOSPermission()}catch(e){console.log(e)}})()}createOneSignalUser(){var t=this;return(0,l.Z)(function*(){try{const e=yield t.getStorage("auth");if(console.log("stored data: ",e),!e||null==e||!e.value)return void t.createUserAndLogin();console.log("external id: ",e.value);const i=yield c(t.onesignal.checkOneSignalUserIdentity(e.value));if(i){const{identity:o}=i;console.log("identity: ",o),null!=o&&o.external_id?(t.onesignal.login(null==o?void 0:o.external_id),t.showToast("User already registered in onesignal")):t.createUserAndLogin()}else t.createUserAndLogin()}catch(e){console.log(e)}})()}createUserAndLogin(){var t=this;return(0,l.Z)(function*(){try{const e=t.generateRandomString(20);console.log("stored number: ",e),yield c(t.onesignal.createOneSignalUser(e)),yield m.set({key:"auth",value:e}),t.onesignal.login(e),t.showToast("User created in onesignal")}catch(e){throw e}})()}showToast(t,e="success",i=3e3){var o=this;return(0,l.Z)(function*(){(yield o.toastCtrl.create({message:t,duration:i,color:e,position:"bottom"})).present()})()}generateRandomString(t){let i="";for(let o=0;o<t;o++){const u=Math.floor(62*Math.random());i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(u)}return i}deleteOneSignalUser(){var t=this;return(0,l.Z)(function*(){try{const e=yield t.getStorage("auth");if(null==e||!e.value)return;console.log("external id: ",e.value);const i=yield c(t.onesignal.checkOneSignalUserIdentity(e.value)),{identity:o}=i;console.log("identity: ",o),yield c(t.onesignal.deleteOneSignalUser(null==o?void 0:o.external_id)),t.showToast("User deleted from onesignal")}catch(e){console.log(e)}})()}getStorage(t){return m.get({key:t})}sendNotificationtoSpecificDevice(){var t=this;return(0,l.Z)(function*(){try{const e=yield t.getStorage("auth");null!=e&&e.value&&(yield c(t.onesignal.sendNotification("This is a test message","Test message",{type:"user1"},[e.value]))),console.log(e)}catch(e){console.log(e)}})()}sendNotificationtoAllUsers(){var t=this;return(0,l.Z)(function*(){try{yield c(t.onesignal.sendNotification("This is a test message to all users","Test message for users",{type:"user12"}))}catch(e){console.log(e)}})()}sendNotificationtoSpecificDeviceFromWeb(){var t=this;return(0,l.Z)(function*(){try{yield c(t.onesignal.sendNotification("This is a test message","Test message",{type:"user1"},["coHcnUkQifwJunY37EgT"]))}catch(e){console.log(e)}})()}}return(a=g).\u0275fac=function(t){return new(t||a)(n.Y36(r.yF))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-home"]],standalone:!0,features:[n.jDz],decls:15,vars:1,consts:[[3,"translucent"],[1,"ion-padding"],["expand","block",1,"ion-margin-bottom",3,"click"],["expand","block",3,"click"]],template:function(t,e){1&t&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),n._uU(3," OneSignal Push Notifications "),n.qZA()()(),n.TgZ(4,"ion-content",1)(5,"ion-button",2),n.NdJ("click",function(){return e.createOneSignalUser()}),n._uU(6,"Create Onesignal User"),n.qZA(),n.TgZ(7,"ion-button",2),n.NdJ("click",function(){return e.deleteOneSignalUser()}),n._uU(8,"Delete Onesignal User"),n.qZA(),n.TgZ(9,"ion-button",2),n.NdJ("click",function(){return e.sendNotificationtoSpecificDevice()}),n.TgZ(10,"ion-text"),n._uU(11," Send notification to specific device "),n.qZA()(),n.TgZ(12,"ion-button",3),n.NdJ("click",function(){return e.sendNotificationtoAllUsers()}),n.TgZ(13,"ion-text"),n._uU(14," Send notification to all devices "),n.qZA()()()),2&t&&n.Q6J("translucent",!0)},dependencies:[r.Gu,r.sr,r.wd,r.W2,r.YG,r.yW],styles:["ion-text[_ngcontent-%COMP%]{font-size:.9rem}"]}),g})()}}]);